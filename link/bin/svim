#!/bin/bash

if [[ -z $1 ]]; then
    echo "No file passed."
    exit 1
fi

if [[ -d $1 ]]; then
    echo "$1 is a directory."
    exit 1
fi

temp_name="/tmp/$(basename "$1")"
if [[ -f $1 ]]; then
    cp "$1" "$temp_name"
fi

nvim "$temp_name"
if [[ ! -e $temp_name ]]; then
    exit 0
fi
doas mv -i "$temp_name" "$1"
if [[ -e $temp_name ]]; then
    rm $temp_name
fi
