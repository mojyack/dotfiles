#!/usr/bin/env python
import sys
import os

def main():
    if len(sys.argv) < 2:
        print("Too few arguments")
        return

    path = os.path.abspath(sys.argv[1])
    files = [f for f in os.listdir(path) if os.path.isfile(os.path.join(path, f))]
    files.sort()

    path_bak = os.path.join(path, '..', os.path.basename(path) + ".old")
    os.mkdir(path_bak)

    i = 1
    for f in files:
        s = os.path.join(path, f)
        b = os.path.join(path_bak, f)
        d = os.path.join(path, f"{i:03d}" + os.path.splitext(f)[1])
        os.link(s, b)
        os.rename(s,d)
        i += 1

main()
